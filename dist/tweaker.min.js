/*! tweaker 13-04-2013 */
(function(){function e(t,n){this.panels=[].slice.call(t.querySelectorAll("div")).map(function(e){return{element:e}}),this._element=t,this._pinned=!1,this._open=!1,this._pinLink=null,this._buildDom(),this.changeAlignment(n||e.ALIGN.RIGHT)}e.prototype.openPanel=function(e){var t=e.element.classList.contains("hidden")||e.link.classList.contains("selected")&&this._pinned;this.hide(),t?(this._element.classList.add("open"),e.element.classList.remove("hidden"),e.link.classList.add("selected"),this._open=!0):e.element.classList.add("hidden")},e.prototype.changeAlignment=function(t){var n=this._element;Object.keys(e.ALIGN).map(function(t){return e.ALIGN[t]}).forEach(function(e){document.body.classList.remove("tweaker-"+e),n.classList.remove(e)}),document.body.classList.add("tweaker-"+t),n.classList.add(t)},e.prototype.show=function(){this.openPanel(this.panels[0])},e.prototype.hide=function(){for(var e=0;this.panels.length>e;e++)this.panels[e].element.classList.add("hidden"),this.panels[e].link.classList.remove("selected");this._pinned||(this._element.classList.remove("open"),this._open=!1)},e.prototype._buildDom=function(){var e,t=document.createElement("ul"),n=document.createElement("ul");this._element.classList.add("tweaker"),t.classList.add("panels"),n.classList.add("tools"),this._pinLink=this._addLinkTo(n,"Pin",this._pinClicked.bind(this));for(var i=0;this.panels.length>i;i++)e=this.panels[i],e.element.classList.add("panel"),e.element.classList.add("hidden"),e.link=this._addLinkTo(t,e.element.getAttribute("data-title"),this._linkClicked.bind(this,e));document.documentElement.addEventListener("mousedown",this._bodyClicked.bind(this)),this._element.appendChild(t),this._element.appendChild(n)},e.prototype._addLinkTo=function(e,t,n){var i=document.createElement("li"),s=document.createElement("a");return s.href="#",s.innerText=t,s.addEventListener("click",n),i.appendChild(s),e.appendChild(i),s},e.prototype._pinClicked=function(e){e.preventDefault(),this._pinned?(document.body.classList.remove("tweaker-pinned"),this._pinLink.classList.remove("selected")):(document.body.classList.add("tweaker-pinned"),this._pinLink.classList.add("selected"),this._open||this.show()),this._pinned=!this._pinned},e.prototype._bodyClicked=function(e){var t=e.target,n=!1;do if(t===this._element){n=!0;break}while(t=t.parentNode);n||this._pinned||this.hide()},e.prototype._linkClicked=function(e,t){t.preventDefault(),this.openPanel(e)},e.ALIGN={RIGHT:"right",BOTTOM:"bottom",LEFT:"left",TOP:"top"},window.Tweaker=e})();